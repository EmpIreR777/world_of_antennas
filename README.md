# Проект: Система управления заявками и задолженностями для магазина "Мир Антенн"

Этот проект представляет собой веб-приложение и Telegram-бота для управления заявками через вебхук, задолженностями и услугами магазина "Мир Антенн". Приложение позволяет пользователям создавать заявки на услуги, администраторам — управлять заявками и задолженностями, а также отправлять уведомления через Telegram.

---

## Цели проекта

- Упростить процесс управления заявками и задолженностями.
- Повысить прозрачность взаимодействия между клиентами, администраторами и работниками.
- Автоматизировать уведомления и взаимодействие через Telegram.
- Обеспечить удобный доступ к статистике и аналитике.

---

## Основные функции

### Для пользователей:

- Создание заявок на услуги (установка, ремонт, диагностика антенн и т.д.).
- Просмотр статуса своих заявок.
- Получение уведомлений о статусе заявок через Telegram.

### Для администраторов:

- Управление заявками (изменение статусов, назначение мастеров).
- Управление задолженностями (добавление, обновление, удаление товаров в долг).
- Просмотр статистики по заявкам и пользователям.
- Отправка сообщений всем пользователям или работникам через Telegram (текст, фото, видео, аудио).

### Для работников:

- Просмотр списка задолженностей.
- Управление своими задолженностями.

---

## Архитектура

Проект состоит из следующих компонентов:

1. **Backend**:
   - Реализован на FastAPI.
   - Использует SQLAlchemy для работы с базой данных.
   - Поддерживает REST API для взаимодействия с клиентами.

2. **Frontend**:
   - Использует HTML, Jinja2, CSS и JavaScript для отображения интерфейса.

3. **Telegram Bot**:
   - Реализован с использованием Aiogram-3.
   - Поддерживает взаимодействие с пользователями через вебхуки.

4. **База данных**:
   - PostgreSQL или SQLite (в зависимости от окружения).

5. **Интеграции**:
   - Yandex Geocoder API для работы с геолокацией.

---

## Технологии

- **Backend**: FastAPI, SQLAlchemy.
- **База данных**: PostgreSQL или SQLite.
- **Frontend**: HTML, Jinja2, CSS, JS.
- **Telegram Bot**: Aiogram-3.
- **Дополнительные инструменты**: Docker, Docker Compose, Yandex Geocoder API.

---

## Требования

- Python 3.12 или выше.
- Docker и Docker Compose (для контейнеризации).
- PostgreSQL (для работы с базой данных).
- Установленный Telegram-аккаунт для работы с ботом.

---

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone git@github.com:EmpIreR777/world_of_antennas.git
   ```
2. Создайте виртуальное окружение:
    ```bash
    python3.12 -m venv venv
    source venv/bin/activate  # Для Linux/MacOS
    venv\Scripts\activate     # Для Windows
    ```
3. Установите зависимости:
    ```bash
    pip install -r requirements.txt
    ```

---

## Настройка окружения

1. Создайте файл `.env` в корневой директории проекта с следующими переменными:
    ```bash
    BOT_TOKEN=
    ADMIN_IDS=
    BASE_SITE=
    YANDEX_API_KEY=
    DATABASE_URL=
    ```

2. Пример `.env` файла:
    ```env
    SECRET_KEY=your
    ALGORITHM=HS256
    POSTGRES_USER=postgre_user
    POSTGRES_PASSWORD=postgre_password
    POSTGRES_DB=postgres_db
    POSTGRES_HOST=db
    POSTGRES_PORT=5432
    ```

---

## Запуск приложения

### Локальный запуск
```bash
uvicorn app.main:app --reload
```

### Запуск через Docker-compose

1. Соберите и запустите контейнеры:
    ```bash
    docker-compose up -d --build
    ```
2. Приложение будет доступно по адресу:
    ```bash
    http://localhost:5000
    ```

---

## API документация

После запуска приложения документация Swagger доступна по адресу:
- [Swagger UI](http://localhost:5000/docs) — интерактивная документация.
- [ReDoc](http://localhost:5000/redoc) — альтернативная документация.

---

## Администрирование

Для управления данными используется административная панель, доступная по адресу `/admin`. Для входа в панель администратора необходимо использовать учетные данные, указанные в базе данных:
```bash
http://127.0.0.1:5000/admin/
```

---

## Примеры данных

- Пользователи (администраторы, мастера, операторы, клиенты).
- Магазины и услуги.
- Заявки и задолженности.

---
